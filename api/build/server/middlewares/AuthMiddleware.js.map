{"version":3,"sources":["../../../server/middlewares/AuthMiddleware.js"],"names":["authenticate","req","res","next","sentToken","get","status","send","JWT","verifyToken","jwt","tokenExp","token","decode"],"mappings":";;;;;;;AACA;;AACA;;;;;;;;AAEA,IAAMA,YAAY;AAAA;AAAA;AAAA;AAAA;AAAA,0BAAG,iBAAOC,GAAP,EAAYC,GAAZ,EAAiBC,IAAjB;AAAA;AAAA;AAAA;AAAA;AAAA;AACbC,YAAAA,SADa,GACDH,GAAG,CAACI,GAAJ,CAAQ,gBAAR,CADC;;AAAA,gBAEdD,SAFc;AAAA;AAAA;AAAA;;AAGjBF,YAAAA,GAAG,CAACI,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB,mCAArB;AAHiB;AAAA;;AAAA;AAAA;AAAA,mBAKCC,gBAAIC,WAAJ,CAAgBL,SAAhB,CALD;;AAAA;AAKXM,YAAAA,GALW;;AAMjB,gBAAIA,GAAG,CAACC,QAAR,EAAkB;AAChBT,cAAAA,GAAG,CAACI,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB,uCAArB;AACD,aAFD,MAEO;AACLN,cAAAA,GAAG,CAACW,KAAJ,GAAYF,GAAG,CAACG,MAAhB;AACAV,cAAAA,IAAI;AACL;;AAXgB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAH;;AAAA,kBAAZH,YAAY;AAAA;AAAA;AAAA,GAAlB;;eAeeA,Y","sourcesContent":["/* eslint-disable linebreak-style */\r\nimport JWT from '../authentication/JWT';\r\nimport { errorNoHeader, errorExpiredToken } from '../helpers/errorHandlers';\r\n\r\nconst authenticate = async (req, res, next) => {\r\n  const sentToken = req.get('Authentication');\r\n  if (!sentToken) {\r\n    res.status(401).send(errorNoHeader());\r\n  } else {\r\n    const jwt = await JWT.verifyToken(sentToken);\r\n    if (jwt.tokenExp) {\r\n      res.status(401).send(errorExpiredToken());\r\n    } else {\r\n      req.token = jwt.decode;\r\n      next();\r\n    }\r\n  }\r\n};\r\n\r\nexport default authenticate;\r\n"],"file":"AuthMiddleware.js"}