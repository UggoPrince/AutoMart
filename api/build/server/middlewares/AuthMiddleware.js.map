{"version":3,"sources":["../../../server/middlewares/AuthMiddleware.js"],"names":["authenticate","req","res","next","sentToken","get","token","status","send","slice","length","JWT","verifyToken","jwt","tokenExp","decode"],"mappings":";;;;;;;AACA;;AACA;;;;;;;;AAEA,IAAMA,YAAY;AAAA;AAAA;AAAA;AAAA;AAAA,0BAAG,iBAAOC,GAAP,EAAYC,GAAZ,EAAiBC,IAAjB;AAAA;AAAA;AAAA;AAAA;AAAA;AACbC,YAAAA,SADa,GACDH,GAAG,CAACI,GAAJ,CAAQ,eAAR,CADC;AAEfC,YAAAA,KAFe,GAEP,EAFO;;AAAA,gBAGdF,SAHc;AAAA;AAAA;AAAA;;AAIjBF,YAAAA,GAAG,CAACK,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB,mCAArB;AAJiB;AAAA;;AAAA;AAMjBF,YAAAA,KAAK,GAAGF,SAAS,CAACK,KAAV,CAAgB,CAAhB,EAAmBL,SAAS,CAACM,MAA7B,CAAR;AANiB;AAAA,mBAOCC,gBAAIC,WAAJ,CAAgBN,KAAhB,CAPD;;AAAA;AAOXO,YAAAA,GAPW;;AAQjB,gBAAIA,GAAG,CAACC,QAAR,EAAkB;AAChBZ,cAAAA,GAAG,CAACK,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB,uCAArB;AACD,aAFD,MAEO;AACLP,cAAAA,GAAG,CAACK,KAAJ,GAAYO,GAAG,CAACE,MAAhB;AACAZ,cAAAA,IAAI;AACL;;AAbgB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAH;;AAAA,kBAAZH,YAAY;AAAA;AAAA;AAAA,GAAlB;;eAiBeA,Y","sourcesContent":["/* eslint-disable linebreak-style */\r\nimport JWT from '../authentication/JWT';\r\nimport { errorNoHeader, errorExpiredToken } from '../helpers/errorHandlers';\r\n\r\nconst authenticate = async (req, res, next) => {\r\n  const sentToken = req.get('Authorization');\r\n  let token = '';\r\n  if (!sentToken) {\r\n    res.status(401).send(errorNoHeader());\r\n  } else {\r\n    token = sentToken.slice(7, sentToken.length);\r\n    const jwt = await JWT.verifyToken(token);\r\n    if (jwt.tokenExp) {\r\n      res.status(401).send(errorExpiredToken());\r\n    } else {\r\n      req.token = jwt.decode;\r\n      next();\r\n    }\r\n  }\r\n};\r\n\r\nexport default authenticate;\r\n"],"file":"AuthMiddleware.js"}