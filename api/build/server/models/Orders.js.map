{"version":3,"sources":["../../../server/models/Orders.js"],"names":["db","Database","Orders","orderData","queryString","buyer","car_id","amount","query","result","rows","price","id","Cars","getCarById","car","order_id"],"mappings":";;;;;;;AACA;;AACA;;;;;;;;;;;;;;AAEA,IAAMA,EAAE,GAAG,IAAIC,oBAAJ,EAAX;;IACMC,M;;;;;;;;;;;;+CACYC,S;;;;;;AACRC,gBAAAA,W,gFAEOD,SAAS,CAACE,K,iBAAYF,SAAS,CAACG,M,iBAAaH,SAAS,CAACI,M;;uBAE/CP,EAAE,CAACQ,KAAH,CAASJ,WAAT,C;;;AAAfK,gBAAAA,M;AACNA,gBAAAA,MAAM,CAACC,IAAP,CAAY,CAAZ,EAAeC,KAAf,GAAuBR,SAAS,CAACQ,KAAjC;iDACOF,M;;;;;;;;;;;;;;;;;;;;;gDAGWG,E;;;;;;;uBACAC,iBAAKC,UAAL,CAAgBF,EAAhB,C;;;AAAZG,gBAAAA,G;kDACCA,G;;;;;;;;;;;;;;;;;;;;;gDAGUH,E;;;;;;AACXR,gBAAAA,W,8CAAkDQ,E;;uBACnCZ,EAAE,CAACQ,KAAH,CAASJ,WAAT,C;;;AAAfK,gBAAAA,M;kDACCA,M;;;;;;;;;;;;;;;;;;;;;gDAGaJ,K;;;;;;AACdD,gBAAAA,W,mTAKiBC,K;;uBACFL,EAAE,CAACQ,KAAH,CAASJ,WAAT,C;;;AAAfK,gBAAAA,M;kDACCA,M;;;;;;;;;;;;;;;;;;;;;gDAGSN,S;;;;;;AACVC,gBAAAA,W,+CACwBD,SAAS,CAACQ,K,gCAC1BR,SAAS,CAACa,Q;;uBAEHhB,EAAE,CAACQ,KAAH,CAASJ,WAAT,C;;;AAAfK,gBAAAA,M;kDACCA,M;;;;;;;;;;;;;;;;;;;;;eAGI,IAAIP,MAAJ,E","sourcesContent":["/* eslint-disable class-methods-use-this */\nimport Database from '../database/Database';\nimport Cars from './Cars';\n\nconst db = new Database();\nclass Orders {\n  async makeOrder(orderData) {\n    const queryString = `\n      INSERT INTO orders (buyer, car_id, amount)\n      VALUES ('${orderData.buyer}', '${orderData.car_id}', '${orderData.amount}')\n      RETURNING id, car_id, created_on, status, amount;`;\n    const result = await db.query(queryString);\n    result.rows[0].price = orderData.price;\n    return result;\n  }\n\n  async getOrderedCar(id) {\n    const car = await Cars.getCarById(id);\n    return car;\n  }\n\n  async getOrderById(id) {\n    const queryString = `SELECT * FROM orders WHERE id = '${id}';`;\n    const result = await db.query(queryString);\n    return result;\n  }\n\n  async getOrderByBuyer(buyer) {\n    const queryString = `\n      SELECT orders.id, car_id, orders.created_on, amount, orders.status,\n      cars.state car_state, cars.status car_status, cars.price car_price, title,\n      manufacturer, model, body_type, image_url\n      FROM cars FULL JOIN orders ON cars.id = orders.car_id\n      WHERE orders.buyer=${buyer};`;\n    const result = await db.query(queryString);\n    return result;\n  }\n\n  async updatePrice(orderData) {\n    const queryString = `\n    UPDATE orders SET amount = '${orderData.price}'\n    WHERE id = '${orderData.order_id}' AND status = 'pending'\n    RETURNING id, car_id, status, amount;`;\n    const result = await db.query(queryString);\n    return result;\n  }\n}\nexport default new Orders();\n"],"file":"Orders.js"}