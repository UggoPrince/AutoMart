{"version":3,"sources":["../../../server/authentication/JWT.js"],"names":["dotenv","config","JWT","sentToken","jwt","verify","process","env","tokenSecret","err","decode","tokenExp","error","token","data","sign","expiresIn","tokenTime"],"mappings":";;;;;;;AAEA;;AACA;;;;;;;;;;;;;;AAEAA,mBAAOC,MAAP;;IAEMC,G;;;;;;;;;;;;+CACcC,S;;;;;;;uBACIC,yBAAIC,MAAJ,CAAWF,SAAX,YAAyBG,OAAO,CAACC,GAAR,CAAYC,WAArC,GAAoD,UAACC,GAAD,EAAMC,MAAN,EAAiB;AACvF,sBAAID,GAAJ,EAAS;AACP,2BAAO;AAAEE,sBAAAA,QAAQ,EAAE,IAAZ;AAAkBC,sBAAAA,KAAK,EAAEH;AAAzB,qBAAP;AACD;;AACD,yBAAO;AAAEE,oBAAAA,QAAQ,EAAE,KAAZ;AAAmBD,oBAAAA,MAAM,EAANA;AAAnB,mBAAP;AACD,iBALmB,C;;;AAAdG,gBAAAA,K;iDAMCA,K;;;;;;;;;;;;;;;;;;8BAGCC,I,EAAM;AACd;AACA;AACA,aAAOV,yBAAIW,IAAJ,CAASD,IAAT,YAAkBR,OAAO,CAACC,GAAR,CAAYC,WAA9B,GACL;AAAEQ,QAAAA,SAAS,EAAEV,OAAO,CAACC,GAAR,CAAYU;AAAzB,OADK,CAAP;AAED;;;;;;eAGY,IAAIf,GAAJ,E","sourcesContent":["/* eslint-disable linebreak-style */\r\n/* eslint-disable class-methods-use-this */\r\nimport dotenv from 'dotenv';\r\nimport jwt from 'jsonwebtoken';\r\n\r\ndotenv.config();\r\n\r\nclass JWT {\r\n  async verifyToken(sentToken) {\r\n    const token = await jwt.verify(sentToken, `${process.env.tokenSecret}`, (err, decode) => {\r\n      if (err) {\r\n        return { tokenExp: true, error: err };\r\n      }\r\n      return { tokenExp: false, decode };\r\n    });\r\n    return token;\r\n  }\r\n\r\n  signToken(data) {\r\n    // const time = Math.floor(Date.now() / 1000) + process.env.tokenTime;\r\n    // console.log(time);\r\n    return jwt.sign(data, `${process.env.tokenSecret}`,\r\n      { expiresIn: process.env.tokenTime });\r\n  }\r\n}\r\n\r\nexport default new JWT();\r\n"],"file":"JWT.js"}